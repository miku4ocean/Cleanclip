<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CleanClip</title>
  <link rel="stylesheet" href="sidebar.css">
</head>
<body>
  <div id="root">
    <div class="sidebar-container">
      <div class="header">
        <div class="logo">CleanClip</div>
        <div id="loading-message" style="margin-top: 10px; padding: 8px; background: #dbeafe; color: #1d4ed8; border-radius: 4px; font-size: 14px;">
          正在載入擴充功能...
        </div>
      </div>
    </div>
  </div>

  <!-- Load libraries -->
  <script src="lib/text-processor.js"></script>
  <script src="lib/pdf-export.js"></script>
  
  <!-- React CDN with fallback -->
  <script>
    console.log('Loading CleanClip sidebar...');
    
    function loadScript(src, callback) {
      const script = document.createElement('script');
      script.src = src;
      script.onload = callback;
      script.onerror = function() {
        console.error('Failed to load:', src);
        showError('載入失敗: ' + src);
      };
      document.head.appendChild(script);
    }
    
    function showError(message) {
      const root = document.getElementById('root');
      root.innerHTML = `
        <div class="sidebar-container">
          <div class="header">
            <div class="logo">CleanClip</div>
            <div style="margin-top: 10px; padding: 8px; background: #fee2e2; color: #dc2626; border-radius: 4px; font-size: 14px;">
              ${message}
            </div>
            <button onclick="location.reload()" style="margin-top: 8px; padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
              重新載入
            </button>
          </div>
        </div>
      `;
    }
    
    // Load React
    loadScript('https://unpkg.com/react@18/umd/react.production.min.js', function() {
      console.log('React loaded');
      loadScript('https://unpkg.com/react-dom@18/umd/react-dom.production.min.js', function() {
        console.log('ReactDOM loaded');
        // Skip Babel and load simple version
        loadScript('sidebar-simple.js', function() {
          console.log('Sidebar simple script loaded');
        });
      });
    });
  </script>
</body>
</html>